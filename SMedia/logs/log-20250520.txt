[00:42:40 INF] User profile is available. Using 'C:\Users\anhan\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[00:42:40 INF] Request starting HTTP/1.1 GET http://localhost:5295/swagger/index.html - null null
[00:42:40 INF] Request finished HTTP/1.1 GET http://localhost:5295/swagger/index.html - 200 null text/html;charset=utf-8 117.7937ms
[00:42:41 INF] Request starting HTTP/1.1 GET http://localhost:5295/swagger/v1/swagger.json - null null
[00:42:41 INF] Request finished HTTP/1.1 GET http://localhost:5295/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 202.6405ms
[00:42:52 INF] Request starting HTTP/1.1 POST http://localhost:5295/api/user-posts - application/json 231
[00:42:52 INF] HTTP POST /api/user-posts received from ::1
[00:42:52 INF] Request Body: {
  "content": "This is the first post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[00:42:52 INF] HTTP Request Information:
User: Anonymous
Scheme: http
Host: localhost:5295
Method: POST
Path: /api/user-posts
QueryString: None
Query Parameters:
None
Route Parameters:
action: CreateUserPost
controller: UserPosts
Content-Type: application/json
Content-Length: 231
Headers:
Accept: */*
Connection: keep-alive
Host: localhost:5295
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-US,en;q=0.9,vi;q=0.8
Content-Type: application/json
Origin: http://localhost:5295
Referer: http://localhost:5295/swagger/index.html
Content-Length: 231
sec-ch-ua-platform: "Windows"
sec-ch-ua: "Chromium";v="136", "Microsoft Edge";v="136", "Not.A/Brand";v="99"
sec-ch-ua-mobile: ?0
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Body:
{
  "content": "This is the first post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[00:42:52 INF] Executing endpoint 'SMedia.Controllers.UserPostsController.CreateUserPost (SMedia)'
[00:42:52 INF] Route matched with {action = "CreateUserPost", controller = "UserPosts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Application.DTOs.PostDtos+PostDto]] CreateUserPost(PostCreateDto) on controller SMedia.Controllers.UserPostsController (SMedia).
[00:42:52 INF] Executing action method SMedia.Controllers.UserPostsController.CreateUserPost (SMedia) - Validation state: "Valid"
[00:42:54 ERR] Failed executing DbCommand (129ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 50), @p2='?' (Size = 255), @p3='?' (DbType = Guid), @p4='?' (DbType = Guid), @p5='?' (DbType = DateTime2), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Media] ([MediaId], [MediaType], [MediaUrl], [MessageId], [PostId], [UploadedAt], [UploadedBy])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
[00:42:54 ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:02b4ec32-8868-4a1c-8a74-dca8c23f9156
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:02b4ec32-8868-4a1c-8a74-dca8c23f9156
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[00:42:54 INF] Executed action SMedia.Controllers.UserPostsController.CreateUserPost (SMedia) in 1680.1915ms
[00:42:54 INF] Executed endpoint 'SMedia.Controllers.UserPostsController.CreateUserPost (SMedia)'
[00:42:54 ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:02b4ec32-8868-4a1c-8a74-dca8c23f9156
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Infrastructure.Repositories.PostRepository.CreateMediaAsync(Media media) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\Infrastructure\Repositories\PostRepository.cs:line 107
   at Application.Services.PostService.CreateUserPostAsync(PostCreateDto postDto, Guid userId) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\Application\Services\PostService.cs:line 38
   at SMedia.Controllers.UserPostsController.CreateUserPost(PostCreateDto postDto) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Controllers\UserPostsController.cs:line 28
   at lambda_method5(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at SMedia.Configuration.RequestResponseLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Configuration\RequestResponseLoggingMiddleware.cs:line 38
   at SMedia.Middlewares.HttpLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Middlewares\HttpLoggingMiddleware.cs:line 32
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
[00:42:54 ERR] An exception was thrown attempting to display the error page.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.DisplayExceptionContent(ErrorContext errorContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
[00:42:54 ERR] Connection id "0HNCMVI6O9ROL", Request id "0HNCMVI6O9ROL:00000003": An unhandled exception was thrown by the application.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:02b4ec32-8868-4a1c-8a74-dca8c23f9156
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Infrastructure.Repositories.PostRepository.CreateMediaAsync(Media media) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\Infrastructure\Repositories\PostRepository.cs:line 107
   at Application.Services.PostService.CreateUserPostAsync(PostCreateDto postDto, Guid userId) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\Application\Services\PostService.cs:line 38
   at SMedia.Controllers.UserPostsController.CreateUserPost(PostCreateDto postDto) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Controllers\UserPostsController.cs:line 28
   at lambda_method5(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at SMedia.Configuration.RequestResponseLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Configuration\RequestResponseLoggingMiddleware.cs:line 38
   at SMedia.Middlewares.HttpLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Middlewares\HttpLoggingMiddleware.cs:line 32
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
[00:42:54 INF] Request finished HTTP/1.1 POST http://localhost:5295/api/user-posts - 500 0 null 1982.4996ms
[00:46:02 INF] User profile is available. Using 'C:\Users\anhan\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[00:46:02 INF] Request starting HTTP/1.1 GET http://localhost:5295/swagger/index.html - null null
[00:46:02 INF] Request finished HTTP/1.1 GET http://localhost:5295/swagger/index.html - 200 null text/html;charset=utf-8 97.692ms
[00:46:02 INF] Request starting HTTP/1.1 GET http://localhost:5295/swagger/v1/swagger.json - null null
[00:46:03 INF] Request finished HTTP/1.1 GET http://localhost:5295/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 124.1473ms
[00:46:06 INF] Request starting HTTP/1.1 POST http://localhost:5295/api/user-posts - application/json 231
[00:46:06 INF] HTTP POST /api/user-posts received from ::1
[00:46:06 INF] Request Body: {
  "content": "This is the first post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[00:46:06 INF] HTTP Request:
User: Anonymous
Scheme: http
Host: localhost:5295
Method: POST
Path: /api/user-posts
Route Parameters:
  action: CreateUserPost
  controller: UserPosts
Content-Type: application/json
Content-Length: 231
Headers:
  Accept: */*
  Connection: keep-alive
  Host: localhost:5295
  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
  Accept-Encoding: gzip, deflate, br, zstd
  Accept-Language: en-US,en;q=0.9,vi;q=0.8
  Content-Type: application/json
  Origin: http://localhost:5295
  Referer: http://localhost:5295/swagger/index.html
  Content-Length: 231
  sec-ch-ua-platform: "Windows"
  sec-ch-ua: "Chromium";v="136", "Microsoft Edge";v="136", "Not.A/Brand";v="99"
  sec-ch-ua-mobile: ?0
  Sec-Fetch-Site: same-origin
  Sec-Fetch-Mode: cors
  Sec-Fetch-Dest: empty
Body:
{
  "content": "This is the first post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[00:46:06 INF] Executing endpoint 'SMedia.Controllers.UserPostsController.CreateUserPost (SMedia)'
[00:46:06 INF] Route matched with {action = "CreateUserPost", controller = "UserPosts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Application.DTOs.PostDtos+PostDto]] CreateUserPost(PostCreateDto) on controller SMedia.Controllers.UserPostsController (SMedia).
[00:46:06 INF] Executing action method SMedia.Controllers.UserPostsController.CreateUserPost (SMedia) - Validation state: "Valid"
[00:46:07 ERR] Failed executing DbCommand (96ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 50), @p2='?' (Size = 255), @p3='?' (DbType = Guid), @p4='?' (DbType = Guid), @p5='?' (DbType = DateTime2), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Media] ([MediaId], [MediaType], [MediaUrl], [MessageId], [PostId], [UploadedAt], [UploadedBy])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
[00:46:07 ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:6ee2375e-5e60-40b4-8cc2-e9682f1453a6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:6ee2375e-5e60-40b4-8cc2-e9682f1453a6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[00:46:07 INF] Executed action SMedia.Controllers.UserPostsController.CreateUserPost (SMedia) in 1571.4157ms
[00:46:07 INF] Executed endpoint 'SMedia.Controllers.UserPostsController.CreateUserPost (SMedia)'
[00:46:07 ERR] Request failed: The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
[00:46:07 INF] HTTP Response (Duration: 1697ms):
StatusCode: 200
[00:46:07 ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:6ee2375e-5e60-40b4-8cc2-e9682f1453a6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Infrastructure.Repositories.PostRepository.CreateMediaAsync(Media media) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\Infrastructure\Repositories\PostRepository.cs:line 107
   at Application.Services.PostService.CreateUserPostAsync(PostCreateDto postDto, Guid userId) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\Application\Services\PostService.cs:line 38
   at SMedia.Controllers.UserPostsController.CreateUserPost(PostCreateDto postDto) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Controllers\UserPostsController.cs:line 28
   at lambda_method5(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at SMedia.Configuration.RequestResponseLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Configuration\RequestResponseLoggingMiddleware.cs:line 40
   at SMedia.Configuration.RequestResponseLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Configuration\RequestResponseLoggingMiddleware.cs:line 60
   at SMedia.Middlewares.HttpLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Middlewares\HttpLoggingMiddleware.cs:line 32
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
[00:46:07 ERR] An exception was thrown attempting to display the error page.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.DisplayExceptionContent(ErrorContext errorContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
[00:46:07 ERR] Connection id "0HNCMVK2TFGA0", Request id "0HNCMVK2TFGA0:00000003": An unhandled exception was thrown by the application.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:6ee2375e-5e60-40b4-8cc2-e9682f1453a6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Infrastructure.Repositories.PostRepository.CreateMediaAsync(Media media) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\Infrastructure\Repositories\PostRepository.cs:line 107
   at Application.Services.PostService.CreateUserPostAsync(PostCreateDto postDto, Guid userId) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\Application\Services\PostService.cs:line 38
   at SMedia.Controllers.UserPostsController.CreateUserPost(PostCreateDto postDto) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Controllers\UserPostsController.cs:line 28
   at lambda_method5(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at SMedia.Configuration.RequestResponseLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Configuration\RequestResponseLoggingMiddleware.cs:line 40
   at SMedia.Configuration.RequestResponseLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Configuration\RequestResponseLoggingMiddleware.cs:line 60
   at SMedia.Middlewares.HttpLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Middlewares\HttpLoggingMiddleware.cs:line 32
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
[00:46:07 INF] Request finished HTTP/1.1 POST http://localhost:5295/api/user-posts - 500 0 null 1791.2425ms
[00:51:31 INF] HTTP POST /api/user-posts received from ::1
[00:51:31 INF] Request Body: {
  "content": "This is the first post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[00:51:31 INF] Request: Method: POST
Path: /api/user-posts
Authenticated: Yes
Token: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiZjQ5Y2JlMTItMDRmZS00OTlhLWFhNmMtM2Q2ZTFhNmY2ZDU2IiwidXNlcm5hbWUiOiJhbmgwMSIsImltYWdlIjoiaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vZGFwdnZkeHc3L2ltYWdlL3VwbG9hZC92MTc0NzE1OTYzNi9hdmF0YXJfbDJyd3RoLmpwZyIsImV4cCI6MTc1MDE3OTU0OSwiaXNzIjoiTXlBcHAiLCJhdWQiOiJNeUNsaWVudEFwcCJ9.VREJ_Vsv0nRg8O-ZVhx7ZAcgi5NNk6A1x2LV-r50bdc
Body:
{
  "content": "This is the first post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[00:51:32 ERR] Failed executing DbCommand (88ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 50), @p2='?' (Size = 255), @p3='?' (DbType = Guid), @p4='?' (DbType = Guid), @p5='?' (DbType = DateTime2), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Media] ([MediaId], [MediaType], [MediaUrl], [MessageId], [PostId], [UploadedAt], [UploadedBy])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
[00:51:32 ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:c8ce15e8-3355-475c-9ed9-56f9b4d51c04
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:c8ce15e8-3355-475c-9ed9-56f9b4d51c04
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[00:51:32 ERR] Error: The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
[00:51:32 INF] Response (Duration: 1518ms): StatusCode: 200
[00:51:32 ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:c8ce15e8-3355-475c-9ed9-56f9b4d51c04
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Infrastructure.Repositories.PostRepository.CreateMediaAsync(Media media) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\Infrastructure\Repositories\PostRepository.cs:line 107
   at Application.Services.PostService.CreateUserPostAsync(PostCreateDto postDto, Guid userId) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\Application\Services\PostService.cs:line 38
   at SMedia.Controllers.UserPostsController.CreateUserPost(PostCreateDto postDto) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Controllers\UserPostsController.cs:line 28
   at lambda_method5(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at SMedia.Configuration.RequestResponseLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Configuration\RequestResponseLoggingMiddleware.cs:line 42
   at SMedia.Configuration.RequestResponseLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Configuration\RequestResponseLoggingMiddleware.cs:line 65
   at SMedia.Middlewares.HttpLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Middlewares\HttpLoggingMiddleware.cs:line 32
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
[00:51:32 ERR] An exception was thrown attempting to display the error page.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.DisplayExceptionContent(ErrorContext errorContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
[00:51:32 ERR] Connection id "0HNCMVN41V6PD", Request id "0HNCMVN41V6PD:00000003": An unhandled exception was thrown by the application.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:c8ce15e8-3355-475c-9ed9-56f9b4d51c04
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Infrastructure.Repositories.PostRepository.CreateMediaAsync(Media media) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\Infrastructure\Repositories\PostRepository.cs:line 107
   at Application.Services.PostService.CreateUserPostAsync(PostCreateDto postDto, Guid userId) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\Application\Services\PostService.cs:line 38
   at SMedia.Controllers.UserPostsController.CreateUserPost(PostCreateDto postDto) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Controllers\UserPostsController.cs:line 28
   at lambda_method5(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at SMedia.Configuration.RequestResponseLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Configuration\RequestResponseLoggingMiddleware.cs:line 42
   at SMedia.Configuration.RequestResponseLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Configuration\RequestResponseLoggingMiddleware.cs:line 65
   at SMedia.Middlewares.HttpLoggingMiddleware.InvokeAsync(HttpContext context) in E:\hcmue_03_hk02\cn_web\BACK_END\BackEnd-SocialMedia\SMedia\Middlewares\HttpLoggingMiddleware.cs:line 32
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
[00:53:48 INF] HTTP POST /api/user-posts received from ::1
[00:53:48 INF] Request Body: {
  "content": "This is the first post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[00:53:48 INF] Request: Method: POST
Path: /api/user-posts
Authenticated: Yes
Token: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiZjQ5Y2JlMTItMDRmZS00OTlhLWFhNmMtM2Q2ZTFhNmY2ZDU2IiwidXNlcm5hbWUiOiJhbmgwMSIsImltYWdlIjoiaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vZGFwdnZkeHc3L2ltYWdlL3VwbG9hZC92MTc0NzE1OTYzNi9hdmF0YXJfbDJyd3RoLmpwZyIsImV4cCI6MTc1MDE3OTU0OSwiaXNzIjoiTXlBcHAiLCJhdWQiOiJNeUNsaWVudEFwcCJ9.VREJ_Vsv0nRg8O-ZVhx7ZAcgi5NNk6A1x2LV-r50bdc
Body:
{
  "content": "This is the first post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[00:53:49 ERR] Error: The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
The statement has been terminated.
[00:53:49 INF] Response (Duration: 1652ms): StatusCode: 500
[00:57:05 INF] HTTP POST /api/user-posts received from ::1
[00:57:05 INF] Request Body: {
  "content": "This is the first post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[00:57:05 INF] Request: Method: POST
Path: /api/user-posts
Authenticated: Yes
Token: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiZjQ5Y2JlMTItMDRmZS00OTlhLWFhNmMtM2Q2ZTFhNmY2ZDU2IiwidXNlcm5hbWUiOiJhbmgwMSIsImltYWdlIjoiaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vZGFwdnZkeHc3L2ltYWdlL3VwbG9hZC92MTc0NzE1OTYzNi9hdmF0YXJfbDJyd3RoLmpwZyIsImV4cCI6MTc1MDE3OTU0OSwiaXNzIjoiTXlBcHAiLCJhdWQiOiJNeUNsaWVudEFwcCJ9.VREJ_Vsv0nRg8O-ZVhx7ZAcgi5NNk6A1x2LV-r50bdc
Body:
{
  "content": "This is the first post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[00:57:06 ERR] Error: The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Media_PostId". The conflict occurred in database "SMedia", table "dbo.Posts", column 'PostId'.
[00:57:06 INF] Response (Duration: 1507ms): API: POST /api/user-posts
StatusCode: 500
[01:02:31 INF] HTTP POST /api/user-posts received from ::1
[01:02:31 INF] Request Body: {
  "content": "This is the first post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[01:02:31 INF] Request: Method: POST
Path: /api/user-posts
Authenticated: Yes
Token: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiZjQ5Y2JlMTItMDRmZS00OTlhLWFhNmMtM2Q2ZTFhNmY2ZDU2IiwidXNlcm5hbWUiOiJhbmgwMSIsImltYWdlIjoiaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vZGFwdnZkeHc3L2ltYWdlL3VwbG9hZC92MTc0NzE1OTYzNi9hdmF0YXJfbDJyd3RoLmpwZyIsImV4cCI6MTc1MDE3OTU0OSwiaXNzIjoiTXlBcHAiLCJhdWQiOiJNeUNsaWVudEFwcCJ9.VREJ_Vsv0nRg8O-ZVhx7ZAcgi5NNk6A1x2LV-r50bdc
Body:
{
  "content": "This is the first post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[01:02:34 INF] Response (Duration: 2539ms): API: POST /api/user-posts
StatusCode: 201
Body:
{
  "postId": "00000000-0000-0000-0000-000000000000",
  "userId": "00000000-0000-0000-0000-000000000000",
  "content": "",
  "postedAt": "0001-01-01T00:00:00",
  "groupId": null,
  "isApproved": false,
  "isVisible": false,
  "media": [],
  "voteCount": 0,
  "isVotedByCurrentUser": false,
  "commentCount": 0
}
[01:02:34 INF] HTTP 201 returned for POST /api/user-posts
[01:03:48 INF] HTTP GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56?page=1&pageSize=10 received from ::1
[01:03:48 INF] Request: Method: GET
Path: /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
Authenticated: Yes
Token: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiZjQ5Y2JlMTItMDRmZS00OTlhLWFhNmMtM2Q2ZTFhNmY2ZDU2IiwidXNlcm5hbWUiOiJhbmgwMSIsImltYWdlIjoiaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vZGFwdnZkeHc3L2ltYWdlL3VwbG9hZC92MTc0NzE1OTYzNi9hdmF0YXJfbDJyd3RoLmpwZyIsImV4cCI6MTc1MDE3OTU0OSwiaXNzIjoiTXlBcHAiLCJhdWQiOiJNeUNsaWVudEFwcCJ9.VREJ_Vsv0nRg8O-ZVhx7ZAcgi5NNk6A1x2LV-r50bdc
[01:03:48 INF] Response (Duration: 680ms): API: GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
StatusCode: 200
Body:
[
  {
    "postId": "00000000-0000-0000-0000-000000000000",
    "userId": "00000000-0000-0000-0000-000000000000",
    "content": "",
    "postedAt": "0001-01-01T00:00:00",
    "groupId": null,
    "isApproved": false,
    "isVisible": false,
    "media": [],
    "voteCount": 0,
    "isVotedByCurrentUser": false,
    "commentCount": 0
  }
]
[01:03:48 INF] HTTP 200 returned for GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
[01:04:48 INF] HTTP GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56?page=1&pageSize=10 received from ::1
[01:04:48 INF] Request: Method: GET
Path: /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
Authenticated: Yes
Token: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiZjQ5Y2JlMTItMDRmZS00OTlhLWFhNmMtM2Q2ZTFhNmY2ZDU2IiwidXNlcm5hbWUiOiJhbmgwMSIsImltYWdlIjoiaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vZGFwdnZkeHc3L2ltYWdlL3VwbG9hZC92MTc0NzE1OTYzNi9hdmF0YXJfbDJyd3RoLmpwZyIsImV4cCI6MTc1MDE3OTU0OSwiaXNzIjoiTXlBcHAiLCJhdWQiOiJNeUNsaWVudEFwcCJ9.VREJ_Vsv0nRg8O-ZVhx7ZAcgi5NNk6A1x2LV-r50bdc
[01:04:48 INF] Response (Duration: 581ms): API: GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
StatusCode: 200
Body:
[
  {
    "postId": "00000000-0000-0000-0000-000000000000",
    "userId": "00000000-0000-0000-0000-000000000000",
    "content": "",
    "postedAt": "0001-01-01T00:00:00",
    "groupId": null,
    "isApproved": false,
    "isVisible": false,
    "media": [],
    "voteCount": 0,
    "isVotedByCurrentUser": false,
    "commentCount": 0
  }
]
[01:04:48 INF] HTTP 200 returned for GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
[01:07:47 INF] HTTP GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56?page=1&pageSize=10 received from ::1
[01:07:47 INF] Request: URL: http://localhost:5295/api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56?page=1&pageSize=10
Authenticated: Yes
Token: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiZjQ5Y2JlMTItMDRmZS00OTlhLWFhNmMtM2Q2ZTFhNmY2ZDU2IiwidXNlcm5hbWUiOiJhbmgwMSIsImltYWdlIjoiaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vZGFwdnZkeHc3L2ltYWdlL3VwbG9hZC92MTc0NzE1OTYzNi9hdmF0YXJfbDJyd3RoLmpwZyIsImV4cCI6MTc1MDE3OTU0OSwiaXNzIjoiTXlBcHAiLCJhdWQiOiJNeUNsaWVudEFwcCJ9.VREJ_Vsv0nRg8O-ZVhx7ZAcgi5NNk6A1x2LV-r50bdc
Path Parameters:
  action: GetUserPosts
  controller: UserPosts
  userId: f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
Query Parameters:
  page: 1
  pageSize: 10
[01:07:50 INF] Response (Duration: 2306ms): API: GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
StatusCode: 200
Body:
[
  {
    "postId": "00000000-0000-0000-0000-000000000000",
    "userId": "00000000-0000-0000-0000-000000000000",
    "content": "",
    "postedAt": "0001-01-01T00:00:00",
    "groupId": null,
    "isApproved": false,
    "isVisible": false,
    "media": [],
    "voteCount": 0,
    "isVotedByCurrentUser": false,
    "commentCount": 0
  }
]
[01:07:50 INF] HTTP 200 returned for GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
[10:46:03 INF] HTTP POST /api/user-posts received from 127.0.0.1
[10:46:03 INF] Request Body: {
  "content": "This is the second post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[10:46:03 INF] Request: URL: http://localhost:5295/api/user-posts
Authenticated: Yes
Token: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiZjQ5Y2JlMTItMDRmZS00OTlhLWFhNmMtM2Q2ZTFhNmY2ZDU2IiwidXNlcm5hbWUiOiJhbmgwMSIsImltYWdlIjoiaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vZGFwdnZkeHc3L2ltYWdlL3VwbG9hZC92MTc0NzE1OTYzNi9hdmF0YXJfbDJyd3RoLmpwZyIsImV4cCI6MTc1MDE3OTU0OSwiaXNzIjoiTXlBcHAiLCJhdWQiOiJNeUNsaWVudEFwcCJ9.VREJ_Vsv0nRg8O-ZVhx7ZAcgi5NNk6A1x2LV-r50bdc
Path Parameters:
  action: CreateUserPost
  controller: UserPosts
Body:
{
  "content": "This is the second post.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[10:46:10 ERR] Error: Input string was not in a correct format. Failure to parse near offset 35. Expected an ASCII digit.
[10:46:10 INF] Response (Duration: 6152ms): API: POST /api/user-posts
StatusCode: 500
[11:42:39 INF] HTTP POST /api/user-posts received from ::1
[11:42:39 INF] Request Body: {
  "content": "This hâhahaaha.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[11:42:39 INF] Request: URL: http://localhost:5295/api/user-posts
Authenticated: Yes
Token: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiZjQ5Y2JlMTItMDRmZS00OTlhLWFhNmMtM2Q2ZTFhNmY2ZDU2IiwidXNlcm5hbWUiOiJhbmgwMSIsImltYWdlIjoiaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vZGFwdnZkeHc3L2ltYWdlL3VwbG9hZC92MTc0NzE1OTYzNi9hdmF0YXJfbDJyd3RoLmpwZyIsImV4cCI6MTc1MDE3OTU0OSwiaXNzIjoiTXlBcHAiLCJhdWQiOiJNeUNsaWVudEFwcCJ9.VREJ_Vsv0nRg8O-ZVhx7ZAcgi5NNk6A1x2LV-r50bdc
Path Parameters:
  action: CreateUserPost
  controller: UserPosts
Body:
{
  "content": "This h\u00E2hahaaha.",
  "media": [
    {
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image"
    }
  ]
}
[11:42:44 INF] Response (Duration: 4219ms): API: POST /api/user-posts
StatusCode: 201
Body:
{
  "postId": "c460c1ec-de65-4f6c-9833-50813934500d",
  "userId": "f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56",
  "content": "This h\u00E2hahaaha.",
  "postedAt": "2025-05-20T04:42:40.4536479Z",
  "groupId": null,
  "isApproved": true,
  "isVisible": true,
  "media": [
    {
      "mediaId": "bd19dc8e-a95c-4ea9-bdb5-26fed18c817d",
      "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
      "mediaType": "Image",
      "uploadedAt": "2025-05-20T04:42:43.8234313Z",
      "uploadedBy": "f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56"
    }
  ],
  "voteCount": 0,
  "isVotedByCurrentUser": false,
  "commentCount": 0
}
[11:42:44 INF] HTTP 201 returned for POST /api/user-posts
[11:43:10 INF] HTTP GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56?page=1&pageSize=10 received from ::1
[11:43:10 INF] Request: URL: http://localhost:5295/api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56?page=1&pageSize=10
Authenticated: Yes
Token: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiZjQ5Y2JlMTItMDRmZS00OTlhLWFhNmMtM2Q2ZTFhNmY2ZDU2IiwidXNlcm5hbWUiOiJhbmgwMSIsImltYWdlIjoiaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vZGFwdnZkeHc3L2ltYWdlL3VwbG9hZC92MTc0NzE1OTYzNi9hdmF0YXJfbDJyd3RoLmpwZyIsImV4cCI6MTc1MDE3OTU0OSwiaXNzIjoiTXlBcHAiLCJhdWQiOiJNeUNsaWVudEFwcCJ9.VREJ_Vsv0nRg8O-ZVhx7ZAcgi5NNk6A1x2LV-r50bdc
Path Parameters:
  action: GetUserPosts
  controller: UserPosts
  userId: f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
Query Parameters:
  page: 1
  pageSize: 10
[11:43:11 INF] Response (Duration: 977ms): API: GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
StatusCode: 200
Body:
[
  {
    "postId": "c460c1ec-de65-4f6c-9833-50813934500d",
    "userId": "f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56",
    "content": "This h\u00E2hahaaha.",
    "postedAt": "2025-05-20T04:42:40.4536479",
    "groupId": null,
    "isApproved": true,
    "isVisible": true,
    "media": [
      {
        "mediaId": "bd19dc8e-a95c-4ea9-bdb5-26fed18c817d",
        "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
        "mediaType": "Image",
        "uploadedAt": "2025-05-20T04:42:43.8234313",
        "uploadedBy": "f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56"
      }
    ],
    "voteCount": 0,
    "isVotedByCurrentUser": false,
    "commentCount": 0
  },
  {
    "postId": "32793a22-fe6b-4541-9f17-c764997fac73",
    "userId": "f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56",
    "content": "This is the first post.",
    "postedAt": "2025-05-19T18:02:31.9211881",
    "groupId": null,
    "isApproved": true,
    "isVisible": true,
    "media": [
      {
        "mediaId": "cd01392a-ea9e-46fc-b477-32916e958508",
        "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
        "mediaType": "Image",
        "uploadedAt": "2025-05-19T18:02:33.2522424",
        "uploadedBy": "f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56"
      }
    ],
    "voteCount": 0,
    "isVotedByCurrentUser": false,
    "commentCount": 0
  }
]
[11:43:11 INF] HTTP 200 returned for GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
[14:15:06 INF] HTTP GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56?page=1&pageSize=10 received from ::1
[14:15:06 INF] Request: URL: http://localhost:5295/api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56?page=1&pageSize=10
Authenticated: Yes
Token: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiZjQ5Y2JlMTItMDRmZS00OTlhLWFhNmMtM2Q2ZTFhNmY2ZDU2IiwidXNlcm5hbWUiOiJhbmgwMSIsImltYWdlIjoiaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vZGFwdnZkeHc3L2ltYWdlL3VwbG9hZC92MTc0NzE1OTYzNi9hdmF0YXJfbDJyd3RoLmpwZyIsImV4cCI6MTc1MDE3OTU0OSwiaXNzIjoiTXlBcHAiLCJhdWQiOiJNeUNsaWVudEFwcCJ9.VREJ_Vsv0nRg8O-ZVhx7ZAcgi5NNk6A1x2LV-r50bdc
Path Parameters:
  action: GetUserPosts
  controller: UserPosts
  userId: f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
Query Parameters:
  page: 1
  pageSize: 10
[14:15:14 INF] Response (Duration: 8528ms): API: GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
StatusCode: 200
Body:
[
  {
    "postId": "c460c1ec-de65-4f6c-9833-50813934500d",
    "userId": "f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56",
    "content": "This h\u00E2hahaaha.",
    "postedAt": "2025-05-20T04:42:40.4536479",
    "groupId": null,
    "isApproved": true,
    "isVisible": true,
    "media": [
      {
        "mediaId": "bd19dc8e-a95c-4ea9-bdb5-26fed18c817d",
        "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
        "mediaType": "Image",
        "uploadedAt": "2025-05-20T04:42:43.8234313",
        "uploadedBy": "f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56"
      }
    ],
    "voteCount": 0,
    "isVotedByCurrentUser": false,
    "commentCount": 0
  },
  {
    "postId": "32793a22-fe6b-4541-9f17-c764997fac73",
    "userId": "f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56",
    "content": "This is the first post.",
    "postedAt": "2025-05-19T18:02:31.9211881",
    "groupId": null,
    "isApproved": true,
    "isVisible": true,
    "media": [
      {
        "mediaId": "cd01392a-ea9e-46fc-b477-32916e958508",
        "mediaUrl": "https://images.wallpapersden.com/image/download/tree-alone-dark-evening-4k_bWZpam2UmZqaraWkpJRobWllrWdma2U.jpg",
        "mediaType": "Image",
        "uploadedAt": "2025-05-19T18:02:33.2522424",
        "uploadedBy": "f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56"
      }
    ],
    "voteCount": 0,
    "isVotedByCurrentUser": false,
    "commentCount": 0
  }
]
[14:15:14 INF] HTTP 200 returned for GET /api/user-posts/f49cbe12-04fe-499a-aa6c-3d6e1a6f6d56
